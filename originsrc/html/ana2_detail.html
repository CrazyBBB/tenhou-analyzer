 <html><head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>牌譜の詳細集計</title>
	<style type="text/css">A:link{color:blue;}A:visited{color:blue;}A:hover{color:red;}BODY,TABLE{font-size:10pt;}</style>
	<style type="text/css">
		TH   {border-bottom:1px solid #CCCCCC;font-weight:normal;}
		TD.c0{border-bottom:1px solid #CCCCCC;text-align:left;background:#F0F0F0;}
		TD.c1{border-bottom:1px solid #CCCCCC;text-align:right;padding:0 4px 0px 4px;border-left:1px solid #CCCCCC;}
		TD.c2{border-bottom:1px solid #CCCCCC;text-align:right;color:#888888;vertical-align:top;}
	</style>
</head><body>
	<script type="text/javascript" src="navi.js"></script>

	<span id=h style="visibility:hidden;color:#FFFFFF;background:#000000;position:absolute;top:0px;left:0px;padding:8px;"></span>
	<center>
	<div id=v></div>
	<hr size=1 color=#CCCCCC>
	<form name=f style="margin:0px;"></form>
	※β公開中です。表示方法や項目は予告無く変更されます。<br>
	<div id=c></div>
	</center>
	<hr size=1 color=#CCCCCC>
	※項目名にマウスを移動すると集計方法が表示されます<br>
	※項目をクリックするとハイライト表示になります<br>
	※大会ロビーの拡張ルールのウマ・オカや各種点数変更などは反映されません。<br>
	※点=点棒 ※回=ダブロンは放銃１回 ※件=ダブロンは放銃２件<br>
	※巡目=嶺上・山・ポン・チーでの取牌で加算 ※副露=暗槓・抜きを除く、加槓は除外<br>
	※明槓の副露巡目は続く嶺上に合わせる<br>
	※副露時の向聴数は発声後、手牌枚数が3n+1枚になった時点で計算(打牌後または嶺上前)<br>
	※良形=(待ち枚数 - 副露を除く手牌での使用枚数)が５以上
	<hr size=1 color=#CCCCCC>
	■解析不具合の検査方法<br>
	１．「○○の特定の牌譜を解析(不具合検査用)」から特定の牌譜を選択<br>
	２．牌譜ビューアで牌譜URLを入力して目視集計<br>
	３．表示されている結果と比較<br>
	４．不具合報告先 support@c-egg.com<br>
	※牌譜URLと集計不具合の詳細をお願いいたします<br>

<script type="text/javascript" src="tenhou.js"></script>
<script type="text/javascript" src="util.js"></script>
<script type="text/javascript">
///////////////////////////////////////////////////////////////////
// TENHOU.NET (C)C-EGG http://tenhou.net/
//-----------------------------------------------------------------
var we=window.external; // 内部関数呼び出し用
var logana=we.mjCommand("CREATEINSTANCE::LOGANA1.0"); // IDispatchLogAnaImpl
var cache=logana.cache; // IDispatchCacheImpl
//var sortAs="CTimeAscent"; // ファイル作成時間の古いものから
var sortAs="CTimeDescent"; // ファイル作成時間の新しいものから(default)
var enumPlayer;
var enumLobbyID;
var enumMatchMask;
var enumMatch;
var enumSkipMask;
var enumSkip;

///////////////////////////////////////////////////////////////////
// MAIN
//-----------------------------------------------------------------
var debug;
var c=[]; // output
var filetw;
///////////////////////////////////////////////////////////////////
function sc2wr(gt,_sc){
	var sc=[_sc[0*2+0],_sc[1*2+0],_sc[2*2+0],_sc[3*2+0]];
	var r=(gt&GT.SANMA?[[0,1,2],[0,1,2]]:[[0,1,2,3],[0,1,2,3]]); // [0]=授受前順位 [1]=授受後順位
	var w=(gt&GT.SANMA?[[0,1,2],[0,1,2]]:[[0,1,2,3],[0,1,2,3]]);
	r[0].sort(function(a,b){return sc[b]-sc[a];});
	sc[0]+=_sc[0*2+1]; // 授受
	sc[1]+=_sc[1*2+1];
	sc[2]+=_sc[2*2+1];
	sc[3]+=_sc[3*2+1];
	r[1].sort(function(a,b){return sc[b]-sc[a];});
	w[0][r[0][0]]=w[1][r[1][0]]=0;
	w[0][r[0][1]]=w[1][r[1][1]]=1;
	w[0][r[0][2]]=w[1][r[1][2]]=2;
	if (~gt&GT.SANMA){
	w[0][r[0][3]]=w[1][r[1][3]]=3;
	}
	return w;
}
function jikaze(gt,kyoku,who){
	if (gt&GT.SANMA){
		if (who==3) return 3; // 常に北家
		return (who+3-(kyoku%4))%3; // ４局目は使用しないこと
	}else{
		return (who+4-(kyoku%4))%4;
	}
}
///////////////////////////////////////////////////////////////////
/*
【オーラス開始時トップ率】略/オーラス開始数
【オーラス順位向上率】略/オーラス数 ※サドンデスを含む
「和了、放銃、被ツモ、横移動、流局」のカテゴリ分け。

【副露時副露に放銃率】
【副露時立直への放銃率】
【副露時和了平均得点】

【立直先制率】
【立直時和了率】立直時に和了した局数/配牌数
【立直時放銃率】立直時に放銃した局数/配牌数
【立直時和了平均得点】
【好形聴牌時立直率】両面以上で立直した局数 / 両面以上で聴牌した局数
【愚形聴牌時立直率】両面未満の場合
【追っかけ立直率】おっかけた局数 / 立直を受けた局数
【追っかけ立直放銃率】追っかけ立直放銃数 / おっかけた局数
【追われ時放銃率】追われ放銃した局数 / おっかけられた局数

【親かぶり率】
【親かぶり平均得点】
【親かぶり平均素点】
【暗槓率】暗槓した局数/配牌数
【槓率】暗槓と明槓した局数/配牌数

【聴牌時の平均待ち数】○面待ち、待ち牌数
【愚形聴牌時聴牌とらず】両面未満で聴牌にならない牌を切った局数 / 両面未満で聴牌した局数
【放銃相手の平均待ち数(○面待ち)】(出来れば対戦相手名も)
【対戦相手立直の平均巡目(立直がかかった巡目)】
【被ツモ率】被ツモ回数/配牌数
【被ツモ収支】合計被ツモ失点/被ツモ回数
先制2副露聴牌率
*/
var MJStatList=[
	"version",		// decodeURIComponent string
	"プレーヤ名",	// decodeURIComponent string
	"条件",			// decodeURIComponent string
///////////////////////////////////////////////////////
 // [対戦|配牌]?[和了|放銃|流局]?.[単位].[状態].[時|へ]?
	"対戦回１位"    ,"対戦回２位"    ,"対戦回３位"    ,"対戦回４位"    ,	// 回
	"対戦回１位一般","対戦回２位一般","対戦回３位一般","対戦回４位一般",	// 回
	"対戦回１位上級","対戦回２位上級","対戦回３位上級","対戦回４位上級",	// 回
	"対戦回１位特上","対戦回２位特上","対戦回３位特上","対戦回４位特上",	// 回
	"対戦回１位鳳凰","対戦回２位鳳凰","対戦回３位鳳凰","対戦回４位鳳凰",	// 回
	"得点",			// 得点
	"配牌回",		// 回
	"配牌収支",		// 点
	"卓R",			// R
///////////////////////////////////////////////////////
	"和了回東家",	// 回
	"和了回南家",	// 回
	"和了回西家",	// 回
	"和了回北家",	// 回
	"和了回立直",	// 回
	"和了回ダマ",	// 回
	"和了回ロン",	// 回
	"和了回素点満貫以上",	// 回
	"和了回素点3900以上",	// 回
	"和了回素点7700以上",	// 回
	"和了回素点11600以上",	// 回
	"和了回一発",	// 回
	"和了回断幺",	// 回
	"和了回平和",	// 回
	"和了回七対",	// 回
	"和了回対々",	// 回
	"和了回混一",	// 回
	"和了回清一",	// 回
	"和了回役牌",	// 回
	"和了回順位不動",	// 回
	"和了巡",			// 巡
	"和了巡立直",		// 巡
	"和了巡ダマ",		// 巡
	"和了収支",			// 点
	"和了収支立直",		// 点
	"和了素点",			// 点
	"和了素点立直", 	// 点
	"和了素点ダマ", 	// 点
	"和了順位変動立直",		// 位
	"和了順位変動ダマ",		// 位
	"和了飜表ドラ",		// 飜(抜きを含む)
	"和了飜裏ドラ",		// 飜
	"和了飜赤ドラ",		// 飜
	"和了飜自風東",	// 回
	"和了飜自風南",	// 回
	"和了飜自風西",	// 回
	"和了飜自風北",	// 回
	"和了飜場風東",	// 回
	"和了飜場風南",	// 回
	"和了飜場風西",	// 回
	"和了飜場風北",	// 回
	"和了飜役牌白",		// 回
	"和了飜役牌發",		// 回
	"和了飜役牌中",		// 回
///////////////////////////////////////////////////////
	"放銃回",		// 回
	"放銃件東家",	// 件
	"放銃件南家",	// 件
	"放銃件西家",	// 件
	"放銃件北家",	// 件
	"放銃件素点満貫以上",	// 件
	"放銃件素点3900以上",	// 件
	"放銃件素点7700以上",	// 件
	"放銃件素点11600以上",	// 件
	"放銃件１副露へ",	// 件(副露は和了者)
	"放銃件２副露へ",	// 件(副露は和了者)
	"放銃件３副露へ",	// 件(副露は和了者)
	"放銃件４副露へ",	// 件(副露は和了者)
	"放銃件立直へ",	// 件
	"放銃件ダマへ",	// 件
	"放銃件一発",	// 件
	"放銃件断幺",	// 件
	"放銃件平和",	// 件
	"放銃件七対",	// 件
	"放銃件対々",	// 件
	"放銃件混一",	// 件
	"放銃件清一",	// 件
	"放銃件役牌",	// 件
	"放銃回立直時",		// 回
	"放銃回順位不動",	// 回
	"放銃順位変動",		// 位
	"放銃巡",			// 巡
	"放銃向聴",			// 向聴
	"放銃回聴牌",		// 回
	"放銃収支",			// 点
	"放銃収支立直時",	// 点
	"放銃素点",			// 点
	"放銃素点１副露へ",	// 点(副露は和了者)
	"放銃素点２副露へ",	// 点(副露は和了者)
	"放銃素点３副露へ",	// 点(副露は和了者)
	"放銃素点４副露へ",	// 点(副露は和了者)
	"放銃素点立直へ",	// 点
	"放銃素点ダマへ",	// 点
	"放銃飜表ドラ",		// 飜(抜きを含む)
	"放銃飜裏ドラ",		// 飜
	"放銃飜赤ドラ",		// 飜
///////////////////////////////////////////////////////
	      "配牌回１副露",       "配牌回２副露",       "配牌回３副露",       "配牌回４副露",	// 回
	      "配牌巡１副露",       "配牌巡２副露",       "配牌巡３副露",       "配牌巡４副露",	// 巡
	        "向聴１副露",         "向聴２副露",         "向聴３副露",         "向聴４副露",	// 回
	    "配牌収支１副露",     "配牌収支２副露",     "配牌収支３副露",     "配牌収支４副露",	// 点
	      "和了回１副露",       "和了回２副露",       "和了回３副露",       "和了回４副露",	// 回
	      "放銃回１副露",       "放銃回２副露",       "放銃回３副露",       "放銃回４副露",	// 回
	      "和了巡１副露",       "和了巡２副露",       "和了巡３副露",       "和了巡４副露",	// 巡
	    "和了素点１副露",     "和了素点２副露",     "和了素点３副露",     "和了素点４副露",	// 点
	"和了順位変動１副露", "和了順位変動２副露", "和了順位変動３副露", "和了順位変動４副露",	// 位
	  "流局回聴牌１副露",   "流局回聴牌２副露",   "流局回聴牌３副露",   "流局回聴牌４副露",	// 回
///////////////////////////////////////////////////////
	"配牌回立直",				// 回
	"配牌回立直良形",			// 回
	"配牌回立直愚形",			// 回 ⇒ 良形から算出可能なので不要
	"配牌回立直振聴",			// 回
	"配牌回立直先制",			// 回
	"配牌回立直追っかけ",		// 回
	"配牌回立直追っかけられ",	// 回
	"配牌巡立直",		// 巡
	"配牌収支立直",	// 点
///////////////////////////////////////////////////////
	"流局回聴牌東家",	// 回
	"流局回聴牌南家",	// 回
	"流局回聴牌西家",	// 回
	"流局回聴牌北家",	// 回
	"流局回聴牌立直",	// 回
	"流局回聴牌ダマ",	// 回
	"流局回不聴",	// 回
	"流局収支聴牌",	// 点
	"流局収支不聴",	// 点
	"流局順位変動聴牌",	// 位
	"流局順位変動不聴",	// 位
///////////////////////////////////////////////////////
	"向聴巡0" ,"向聴巡回0",
	"向聴巡1" ,"向聴巡回1",
	"向聴巡2" ,"向聴巡回2",
	"向聴巡3" ,"向聴巡回3",
	"向聴巡4" ,"向聴巡回4",
	"向聴巡5" ,"向聴巡回5",
	"向聴巡6" ,"向聴巡回6",
	"向聴巡7" ,"向聴巡回7",
	"向聴巡8" ,"向聴巡回8",
	"向聴巡9" ,"向聴巡回9",
	"向聴巡10","向聴巡回10",
	"向聴巡11","向聴巡回11",
	"向聴巡12","向聴巡回12",
	"向聴巡13","向聴巡回13",
	"向聴巡14","向聴巡回14",
	"向聴巡15","向聴巡回15",
	"向聴巡16","向聴巡回16",
	"向聴巡17","向聴巡回17",
	"向聴巡18","向聴巡回18",
	"向聴巡19","向聴巡回19",
];
function MJStat(){
	for(var i in MJStatList) this[MJStatList[i]]=0;
}
///////////////////////////////////////////////////////////////////
var cache_version;
var cache_data;
var loginfo;
var targetFileTW=location.search.substr(1);
function OnAnalyzeBegin(){
	cache_version=undefined;
	debug="";
	c.push(new MJStat());
	filetw=[];
	eh('c','<br><button onclick="stop();">STOP</button>');
}
function OnEnumCache(key,loginfo_){
	if (!loginfo_) return;
	loginfo=loginfo_;
	cache_data=cache.get(key).split("\n");
	if (!cache_version || cache_data[0]<cache_version) cache_version=cache_data[0];
//	debug+=loginfo.filetw+"<br>";
	if (targetFileTW && targetFileTW!=loginfo.filetw) return;

	filetw.push(loginfo.filetw);
	var tw=loginfo.tw;
	var gt=loginfo.wGameType;
	cache_data[ 3]=cache_data[3].split(","); // rate
	cache_data[ 5]=cache_data[5].split(",");
	cache_data[ 7]=cache_data[7].split(",");
	cache_data[ 8]=cache_data[8].split(",");
	cache_data[10]=JSONParse("["+cache_data[10]+"]");
	cache_data[11]=JSONParse("["+cache_data[11]+"]");
	cache_data[12]=JSONParse("["+cache_data[12]+"]");

	var cc=c[c.length-1];
	cc.卓R+=Number(cache_data[3][0]);
	cc.卓R+=Number(cache_data[3][1]);
	cc.卓R+=Number(cache_data[3][2]);
	if (~gt&GT.SANMA){
	cc.卓R+=Number(cache_data[3][3]);
	}

	switch(int(cache_data[7][tw])){
	case 0:cc.対戦回１位++;break;
	case 1:cc.対戦回２位++;break;
	case 2:cc.対戦回３位++;break;
	case 3:cc.対戦回４位++;break;
	}
	switch(int(cache_data[7][tw]) + GT.GETTAKU2(gt)*10){
	case  0:cc.対戦回１位一般++;break;
	case  1:cc.対戦回２位一般++;break;
	case  2:cc.対戦回３位一般++;break;
	case  3:cc.対戦回４位一般++;break;
	case 10:cc.対戦回１位上級++;break;
	case 11:cc.対戦回２位上級++;break;
	case 12:cc.対戦回３位上級++;break;
	case 13:cc.対戦回４位上級++;break;
	case 20:cc.対戦回１位特上++;break;
	case 21:cc.対戦回２位特上++;break;
	case 22:cc.対戦回３位特上++;break;
	case 23:cc.対戦回４位特上++;break;
	case 30:cc.対戦回１位鳳凰++;break;
	case 31:cc.対戦回２位鳳凰++;break;
	case 32:cc.対戦回３位鳳凰++;break;
	case 33:cc.対戦回４位鳳凰++;break;
	}
	cc.得点+=Number(cache_data[5][tw*2+1]);
	cc.配牌回+=cache_data[10].length;

	var n=0;
	for(;n<cache_data[10].length;++n){
		var ii=cache_data[12][n];
		var kyoku=ii[0];
		var kaze=jikaze(gt,kyoku,tw);
		var 立直巡=[-1,-1,-1,-1];
		var 立直順=[-1,-1,-1,-1]; // 発声順番
//		var nHonba=ii[1];
//		var nagare=ii[2];
		var 副露数=[0,0,0,0];
		var 先制１副露者=-1;
		var 先制２副露者=-1;
		for(var i=0;i<cache_data[11][n].length;++i){
			var ac=cache_data[11][n][i];
			var who=ac[0];
			switch(ac.length){
			case 3: // reach
				立直巡[who]=ac[1];
				立直順[who]=4 - (立直順[0]==-1) - (立直順[1]==-1) - (立直順[2]==-1) - (立直順[3]==-1);
				if (ac[2].length!=3){
					debug+="不聴立直<br>";
				}else if (who==tw && ac[2].length==3){
					if (ac[2][1]>=5){
						cc.配牌回立直良形++;
					}else{
						cc.配牌回立直愚形++;
					}
					if (ac[2][2]) cc.配牌回立直振聴++;
					// machi =ac[2][0]
					// machic=ac[2][1]
					// furiten=ac[2][2]
				}
				break;
			case 11: // naki
				if (ac[2]==NAKI.ANKAN || ac[2]==NAKI.NUKI || ac[2]==NAKI.CHAKAN) continue;
				副露数[who]++;
				if (先制１副露者==-1 && 副露数[who]==1) 先制１副露者=who;
				if (先制２副露者==-1 && 副露数[who]==1) 先制２副露者=who;
				if (who==tw) switch(副露数[who]){
				case 1:cc.配牌巡１副露+=ac[8], cc.向聴１副露+=ac[9];break;
				case 2:cc.配牌巡２副露+=ac[8], cc.向聴２副露+=ac[9];break;
				case 3:cc.配牌巡３副露+=ac[8], cc.向聴３副露+=ac[9];break;
				case 4:cc.配牌巡４副露+=ac[8], cc.向聴４副露+=ac[9];break;
				}
				if (who==tw && ac[10].length==3){ // 聴牌
					// machi =ac[10][0]
					// machic=ac[10][1]
					// furiten=ac[10][2]
				}
				break;
			default:
				debug+="unknown ["+ac+"] ac.length="+ac.length+"<br>";
				break;
			}
		}
		if (4<副露数[0]) debug+="副露数[0]="+副露数[0]+"<br>";
		if (4<副露数[1]) debug+="副露数[1]="+副露数[1]+"<br>";
		if (4<副露数[2]) debug+="副露数[2]="+副露数[2]+"<br>";
		if (4<副露数[3]) debug+="副露数[3]="+副露数[3]+"<br>";
		switch(副露数[tw]){
		case 1:cc.配牌回１副露++;break;
		case 2:cc.配牌回２副露++;break;
		case 3:cc.配牌回３副露++;break;
		case 4:cc.配牌回４副露++;break;
		}
		if (立直巡[tw]>-1){
			cc.配牌回立直++;
			cc.配牌巡立直+=立直巡[tw];
			if (立直順[tw]) cc.配牌回立直追っかけ++; else cc.配牌回立直先制++;
			if (立直順[tw]<立直順[(tw+1)%4] ||
				立直順[tw]<立直順[(tw+2)%4] ||
				立直順[tw]<立直順[(tw+3)%4]) cc.配牌回立直追っかけられ++;
		}

		var a=cache_data[10][n];
		var aa=a[0];
		if (aa.length==3){ // 流局
			if (aa[0]==""){
				var w2r=sc2wr(gt,aa[1]);
				var rdifftw=w2r[1][tw]-w2r[0][tw];
				if (aa[2][tw]){
					cc.流局収支聴牌+=aa[1][tw*2+1]*100;
					cc.流局順位変動聴牌+=rdifftw;
					switch(kaze){
					case 0:cc.流局回聴牌東家++;break;
					case 1:cc.流局回聴牌南家++;break;
					case 2:cc.流局回聴牌西家++;break;
					case 3:cc.流局回聴牌北家++;break;
					}
					if      (副露数[tw]==1) cc.流局回聴牌１副露++;
					else if (副露数[tw]==2) cc.流局回聴牌２副露++;
					else if (副露数[tw]==3) cc.流局回聴牌３副露++;
					else if (副露数[tw]==4) cc.流局回聴牌４副露++;
					else if (立直巡[tw]>-1) cc.流局回聴牌立直  ++;
					else                    cc.流局回聴牌ダマ  ++;
				}else{
					cc.流局回不聴++;
					cc.流局収支不聴+=aa[1][tw*2+1]*100;
					cc.流局順位変動不聴+=rdifftw;
				}
//				if (aa[1][tw*2+1]>0) cc.流局収支+=aa[1][tw*2+1];
//				debug+="[R]"+aa[1]+" [0]=["+w2r[0]+"] [1]=["+w2r[1]+"] tw="+tw+"<br>";
			}else{
				// 途中流局、流し満貫
			}
			cc.配牌収支+=aa[1][tw*2+1]*100;
			if      (副露数[tw]==1) cc.配牌収支１副露+=aa[1][tw*2+1]*100;
			else if (副露数[tw]==2) cc.配牌収支２副露+=aa[1][tw*2+1]*100;
			else if (副露数[tw]==3) cc.配牌収支３副露+=aa[1][tw*2+1]*100;
			else if (副露数[tw]==4) cc.配牌収支４副露+=aa[1][tw*2+1]*100;
			else if (立直巡[tw]>-1) cc.配牌収支立直  +=aa[1][tw*2+1]*100;
			continue;
		}
		var 和了=false;
		var 放銃=false;
		var 清算前順位; // ダブロン以上用
		var 清算後順位;
		var nn=0;
		for(;nn<a.length;++nn){
			aa=a[nn];
			var w2r=sc2wr(gt,aa[7]);
			if (nn==         0) 清算前順位=w2r[0][tw]; // ダブロン以上用
			if (nn==a.length-1) 清算後順位=w2r[1][tw];
//			if (a.length>=2) debug+="[A]"+aa[7]+" [0]=["+w2r[0]+"] [1]=["+w2r[1]+"] tw="+tw+"<br>";
			var 役={};
			for(var i=0;i<aa[4].length;i+=2) 役[aa[4][i+0]]=aa[4][i+1]; // [役,飜,役,飜,...]
			for(var i=0;i<aa[5].length;++i ) 役[aa[5][i  ]]=13; // [役満,,...]

			if (aa[0]==tw){
				// 和了
				和了=true;
				switch(kaze){
				case 0:cc.和了回東家++;break;
				case 1:cc.和了回南家++;break;
				case 2:cc.和了回西家++;break;
				case 3:cc.和了回北家++;break;
				}
				if (aa[0]!=aa[9]) cc.和了回ロン++;
				cc.和了素点+=aa[2];
				cc.和了収支+=aa[7][tw*2+1]*100;
				if (立直巡[tw]>-1) cc.和了収支立直+=aa[7][tw*2+1]*100;
				if (aa[3]       ) cc.和了回素点満貫以上 ++;
				if (aa[2]>= 3900) cc.和了回素点3900以上 ++;
				if (aa[2]>= 7700) cc.和了回素点7700以上 ++;
				if (aa[2]>=11600) cc.和了回素点11600以上++;
				cc.和了巡+=aa[10];
				if      (副露数[tw]==1) cc.和了巡１副露+=aa[10], cc.和了素点１副露+=aa[2];
				else if (副露数[tw]==2) cc.和了巡２副露+=aa[10], cc.和了素点２副露+=aa[2];
				else if (副露数[tw]==3) cc.和了巡３副露+=aa[10], cc.和了素点３副露+=aa[2];
				else if (副露数[tw]==4) cc.和了巡４副露+=aa[10], cc.和了素点４副露+=aa[2];
				else if (立直巡[tw]>-1) cc.和了巡立直  +=aa[10], cc.和了素点立直  +=aa[2];
				else                    cc.和了巡ダマ  +=aa[10], cc.和了素点ダマ  +=aa[2];
				if (役[ 2]) cc.和了回一発++;
				if (役[ 8]) cc.和了回断幺++;
				if (役[ 7]) cc.和了回平和++;
				if (役[22]) cc.和了回七対++;
				if (役[28]) cc.和了回対々++;
				if (役[34]) cc.和了回混一++;
				if (役[35]) cc.和了回清一++;
				if (役[10]||役[11]||役[12]||役[13]||
					役[14]||役[15]||役[16]||役[17]||
					役[18]||役[19]||役[20]) cc.和了回役牌++;
				if (役[10]) cc.和了飜自風東+=役[10];
				if (役[11]) cc.和了飜自風南+=役[11];
				if (役[12]) cc.和了飜自風西+=役[12];
				if (役[13]) cc.和了飜自風北+=役[13];
				if (役[14]) cc.和了飜場風東+=役[14];
				if (役[15]) cc.和了飜場風南+=役[15];
				if (役[16]) cc.和了飜場風西+=役[16];
				if (役[17]) cc.和了飜場風北+=役[17];
				if (役[18]) cc.和了飜役牌白+=役[18];
				if (役[19]) cc.和了飜役牌發+=役[19];
				if (役[20]) cc.和了飜役牌中+=役[20];
				if (役[52]) cc.和了飜表ドラ+=役[52];
				if (役[53]) cc.和了飜裏ドラ+=役[53];
				if (役[54]) cc.和了飜赤ドラ+=役[54];
			}else if (aa[0]!=aa[9] && aa[9]==tw){
				// 放銃
				var who=aa[0];
				放銃=true;
				switch(jikaze(gt,kyoku,who)){
				case 0:cc.放銃件東家++;break;
				case 1:cc.放銃件南家++;break;
				case 2:cc.放銃件西家++;break;
				case 3:cc.放銃件北家++;break;
				}
				cc.放銃素点-=aa[2];
				cc.放銃収支+=aa[7][tw*2+1]*100;
				if (立直巡[tw]>-1) cc.放銃収支立直時+=aa[7][tw*2+1]*100;
				if (aa[3]       ) cc.放銃件素点満貫以上 ++;
				if (aa[2]>= 3900) cc.放銃件素点3900以上 ++;
				if (aa[2]>= 7700) cc.放銃件素点7700以上 ++;
				if (aa[2]>=11600) cc.放銃件素点11600以上++;
				cc.放銃巡+=aa[11];
				cc.放銃向聴+=aa[12];
				if (aa[12]==0) cc.放銃回聴牌++;
				if      (副露数[who]==1) cc.放銃件１副露へ++, cc.放銃素点１副露へ-=aa[2];
				else if (副露数[who]==2) cc.放銃件２副露へ++, cc.放銃素点２副露へ-=aa[2];
				else if (副露数[who]==3) cc.放銃件３副露へ++, cc.放銃素点３副露へ-=aa[2];
				else if (副露数[who]==4) cc.放銃件４副露へ++, cc.放銃素点４副露へ-=aa[2];
				else if (立直巡[who]>-1) cc.放銃件立直へ  ++, cc.放銃素点立直へ  -=aa[2];
				else                     cc.放銃件ダマへ  ++, cc.放銃素点ダマへ  -=aa[2];
				if (役[ 2]) cc.放銃件一発++;
				if (役[ 8]) cc.放銃件断幺++;
				if (役[ 7]) cc.放銃件平和++;
				if (役[22]) cc.放銃件七対++;
				if (役[28]) cc.放銃件対々++;
				if (役[34]) cc.放銃件混一++;
				if (役[35]) cc.放銃件清一++;
				if (役[10]||役[11]||役[12]||役[13]||
					役[14]||役[15]||役[16]||役[17]||
					役[18]||役[19]||役[20]) cc.放銃件役牌++;
				if (役[52]) cc.放銃飜表ドラ+=役[52];
				if (役[53]) cc.放銃飜裏ドラ+=役[53];
				if (役[54]) cc.放銃飜赤ドラ+=役[54];
			}
			cc.配牌収支+=aa[7][tw*2+1]*100;
			if      (副露数[tw]==1) cc.配牌収支１副露+=aa[7][tw*2+1]*100;
			else if (副露数[tw]==2) cc.配牌収支２副露+=aa[7][tw*2+1]*100;
			else if (副露数[tw]==3) cc.配牌収支３副露+=aa[7][tw*2+1]*100;
			else if (副露数[tw]==4) cc.配牌収支４副露+=aa[7][tw*2+1]*100;
			else if (立直巡[tw]>-1) cc.配牌収支立直  +=aa[7][tw*2+1]*100;
		}
		var 順位変動=清算後順位 - 清算前順位;
		if (和了){
			if (順位変動==0) cc.和了回順位不動++;
			if      (副露数[tw]==1) cc.和了回１副露++, cc.和了順位変動１副露+=順位変動;
			else if (副露数[tw]==2) cc.和了回２副露++, cc.和了順位変動２副露+=順位変動;
			else if (副露数[tw]==3) cc.和了回３副露++, cc.和了順位変動３副露+=順位変動;
			else if (副露数[tw]==4) cc.和了回４副露++, cc.和了順位変動４副露+=順位変動;
			else if (立直巡[tw]>-1) cc.和了回立直  ++, cc.和了順位変動立直  +=順位変動;
			else                    cc.和了回ダマ  ++, cc.和了順位変動ダマ  +=順位変動;
		}
		if (放銃){ // ダブロン以上は最後の１つでまとめて集計
			cc.放銃回++;
			if (順位変動==0) cc.放銃回順位不動++;
			cc.放銃順位変動+=順位変動;
			if      (副露数[tw]==1) cc.放銃回１副露++;
			else if (副露数[tw]==2) cc.放銃回２副露++;
			else if (副露数[tw]==3) cc.放銃回３副露++;
			else if (副露数[tw]==4) cc.放銃回４副露++;
			else if (立直巡[tw]>-1) cc.放銃回立直時++;
		}
	}

	for(n=0;n<20;++n){
		cc["向聴巡"  +n]+=Number(cache_data[8][n*2+0]);
		cc["向聴巡回"+n]+=Number(cache_data[8][n*2+1]);
	}
}
function OnAnalyzeEnd(){
	var f=document.f;
	var cc=c[c.length-1];
	cc.version="{logana:"+we.mjCommand("VERSION")+",html:\""+document.lastModified+"\",cache:"+cache_version+"}";
	cc.プレーヤ名=encodeURIComponent(enumPlayer);
	cc.条件="{lb:"+f.lb.value+",pf:"+f.pf.value+",taku:"+f.taku.value+"}";

	// 以下temporary
	cc.gt=enumMatch;
	cc.対戦回    =cc.対戦回１位     + cc.対戦回２位     + cc.対戦回３位     + cc.対戦回４位    ;
	cc.対戦回一般=cc.対戦回１位一般 + cc.対戦回２位一般 + cc.対戦回３位一般 + cc.対戦回４位一般;
	cc.対戦回上級=cc.対戦回１位上級 + cc.対戦回２位上級 + cc.対戦回３位上級 + cc.対戦回４位上級;
	cc.対戦回特上=cc.対戦回１位特上 + cc.対戦回２位特上 + cc.対戦回３位特上 + cc.対戦回４位特上;
	cc.対戦回鳳凰=cc.対戦回１位鳳凰 + cc.対戦回２位鳳凰 + cc.対戦回３位鳳凰 + cc.対戦回４位鳳凰;
	cc.和了回=cc.和了回東家 + cc.和了回南家 + cc.和了回西家 + cc.和了回北家;
	cc.放銃件=cc.放銃件東家 + cc.放銃件南家 + cc.放銃件西家 + cc.放銃件北家;
	cc.配牌回副露=cc.配牌回１副露 + cc.配牌回２副露 + cc.配牌回３副露 + cc.配牌回４副露;
	cc.和了回副露=cc.和了回１副露 + cc.和了回２副露 + cc.和了回３副露 + cc.和了回４副露;
	cc.和了巡副露=cc.和了巡１副露 + cc.和了巡２副露 + cc.和了巡３副露 + cc.和了巡４副露;
	cc.放銃回副露=cc.放銃回１副露 + cc.放銃回２副露 + cc.放銃回３副露 + cc.放銃回４副露;
	cc.放銃回非副露時=cc.放銃回 - cc.放銃回副露;
	cc.配牌回１副露以上=cc.配牌回１副露 + cc.配牌回２副露 + cc.配牌回３副露 + cc.配牌回４副露;
	cc.配牌回２副露以上=cc.配牌回２副露 + cc.配牌回３副露 + cc.配牌回４副露;
	cc.配牌回３副露以上=cc.配牌回３副露 + cc.配牌回４副露;
	cc.配牌回４副露以上=cc.配牌回４副露;
	cc.    配牌収支副露  =cc.    配牌収支１副露   + cc.    配牌収支２副露   + cc.    配牌収支３副露   + cc.    配牌収支４副露  ;
	cc.    和了素点副露  =cc.    和了素点１副露   + cc.    和了素点２副露   + cc.    和了素点３副露   + cc.    和了素点４副露  ;
	cc.    放銃素点副露へ =cc.   放銃素点１副露へ + cc.    放銃素点２副露へ + cc.    放銃素点３副露へ + cc.    放銃素点４副露へ;
	cc.      放銃件副露へ=cc.      放銃件１副露へ + cc.      放銃件２副露へ + cc.      放銃件３副露へ + cc.      放銃件４副露へ;
	cc.和了順位変動副露  =cc.和了順位変動１副露   + cc.和了順位変動２副露   + cc.和了順位変動３副露   + cc.和了順位変動４副露  ;
	cc.  流局回聴牌副露  =cc.  流局回聴牌１副露   + cc.  流局回聴牌２副露   + cc.  流局回聴牌３副露   + cc.  流局回聴牌４副露  ;
	cc.和了順位変動=cc.和了順位変動副露 + cc.和了順位変動立直 + cc.和了順位変動ダマ;
	cc.  流局回聴牌=cc.  流局回聴牌副露 + cc.  流局回聴牌立直 + cc.  流局回聴牌ダマ;
	cc.    流局収支=cc.    流局収支聴牌 + cc.    流局収支不聴;
	cc.流局順位変動=cc.流局順位変動聴牌 + cc.流局順位変動不聴;
	cc.      流局回=cc.      流局回聴牌 + cc.      流局回不聴;
	cc.和了回一色=cc.和了回混一 + cc.和了回清一;
	cc.放銃件一色=cc.放銃件混一 + cc.放銃件清一;
	cc.和了飜ドラ=cc.和了飜表ドラ + cc.和了飜裏ドラ + cc.和了飜赤ドラ;
	cc.放銃飜ドラ=cc.放銃飜表ドラ + cc.放銃飜裏ドラ + cc.放銃飜赤ドラ;
	cc.和了飜自風=cc.和了飜自風東 + cc.和了飜自風南 + cc.和了飜自風西 + cc.和了飜自風北; 
	cc.和了飜場風=cc.和了飜場風東 + cc.和了飜場風南 + cc.和了飜場風西 + cc.和了飜場風北; 
	cc.和了飜三元=cc.和了飜役牌白 + cc.和了飜役牌發 + cc.和了飜役牌中;
	cc.卓R =cc.卓R/cc.対戦回/(cc.gt&GT.SANMA?3:4);
	cc.順位=(cc.対戦回１位*1 + cc.対戦回２位*2 + cc.対戦回３位*3 + cc.対戦回４位*4)/cc.対戦回;
	if (cc.gt&GT.SANMA){
		cc.安定R=cc.卓R + 40*30*(2.0 - cc.順位);
		cc.安定段位一般=cc.対戦回３位一般?ff(((cc.対戦回１位一般*30 + cc.対戦回２位一般* 0)/cc.対戦回３位一般 - 20)/10,1,3):"inf.";
		cc.安定段位上級=cc.対戦回３位上級?ff(((cc.対戦回１位上級*50 + cc.対戦回２位上級* 0)/cc.対戦回３位上級 - 20)/10,1,3):"inf.";
		cc.安定段位特上=cc.対戦回３位特上?ff(((cc.対戦回１位特上*70 + cc.対戦回２位特上* 0)/cc.対戦回３位特上 - 20)/10,1,3):"inf.";
		cc.安定段位鳳凰=cc.対戦回３位鳳凰?ff(((cc.対戦回１位鳳凰*90 + cc.対戦回２位鳳凰* 0)/cc.対戦回３位鳳凰 - 20)/10,1,3):"inf.";
	}else{
		cc.安定R=cc.卓R + 40*20*(2.5 - cc.順位);
		cc.安定段位一般=cc.対戦回４位一般?ff(((cc.対戦回１位一般*30 + cc.対戦回２位一般* 0)/cc.対戦回４位一般 - 20)/10,1,3):"inf.";
		cc.安定段位上級=cc.対戦回４位上級?ff(((cc.対戦回１位上級*40 + cc.対戦回２位上級*10)/cc.対戦回４位上級 - 20)/10,1,3):"inf.";
		cc.安定段位特上=cc.対戦回４位特上?ff(((cc.対戦回１位特上*50 + cc.対戦回２位特上*20)/cc.対戦回４位特上 - 20)/10,1,3):"inf.";
		cc.安定段位鳳凰=cc.対戦回４位鳳凰?ff(((cc.対戦回１位鳳凰*60 + cc.対戦回２位鳳凰*30)/cc.対戦回４位鳳凰 - 20)/10,1,3):"inf.";
	}
	show();
}
///////////////////////////////////////////////////////////////////
function hilite(e){
	var c=e.style.background;
	switch(c.toString()){
	case "rgb(238, 255, 238)":case "#eeffee":c="";break;
	case "rgb(255, 238, 238)":case "#ffeeee":c="#eeffee";break;
	case "rgb(238, 238, 255)":case "#eeeeff":c="#ffeeee";break;
	case "rgb(255, 255, 136)":case "#ffff88":c="#eeeeff";break;
	default:c="#ffff88";break;
	}
	e.style.background=c;
}
var MJStatDisp=[
	[-1],
	[0,"対戦数","※正常終了した対戦のみ"			,function(e){return e.対戦回+"回";}],
//	[1,  "一般","※正常終了した対戦のみ"			,function(e){return e.対戦回一般+"回";}],
//	[1,  "上級","※正常終了した対戦のみ"			,function(e){return e.対戦回上級+"回";}],
//	[1,  "特上","※正常終了した対戦のみ"			,function(e){return e.対戦回特上+"回";}],
//	[1,  "鳳凰","※正常終了した対戦のみ"			,function(e){return e.対戦回鳳凰+"回";}],
	[0,"平均順位","全卓の平均順位"						,function(e){return ff(e.順位,1,3)+"位";}],
//	[1,  "一般","一般の平均順位"					,function(e){return ff((e.対戦回１位一般*1 + e.対戦回２位一般*2 + e.対戦回３位一般*3 + e.対戦回４位一般*4),e.対戦回一般,3)+"位";}],
//	[1,  "上級","上級の平均順位"					,function(e){return ff((e.対戦回１位上級*1 + e.対戦回２位上級*2 + e.対戦回３位上級*3 + e.対戦回４位上級*4),e.対戦回上級,3)+"位";}],
//	[1,  "特上","特上の平均順位"					,function(e){return ff((e.対戦回１位特上*1 + e.対戦回２位特上*2 + e.対戦回３位特上*3 + e.対戦回４位特上*4),e.対戦回特上,3)+"位";}],
//	[1,  "鳳凰","鳳凰の平均順位"					,function(e){return ff((e.対戦回１位鳳凰*1 + e.対戦回２位鳳凰*2 + e.対戦回３位鳳凰*3 + e.対戦回４位鳳凰*4),e.対戦回鳳凰,3)+"位";}],
	[1,  "１位率","１位回数 / 対戦数"				,function(e){return ff(e.対戦回１位*100,e.対戦回,2)+"%";},function(e){return e.対戦回１位+"回";}],
	[1,  "２位率","２位回数 / 対戦数"				,function(e){return ff(e.対戦回２位*100,e.対戦回,2)+"%";},function(e){return e.対戦回２位+"回";}],
	[1,  "３位率","３位回数 / 対戦数"				,function(e){return ff(e.対戦回３位*100,e.対戦回,2)+"%";},function(e){return e.対戦回３位+"回";}],
	[1,  "４位率","４位回数 / 対戦数"				,function(e){return e.gt&GT.SANMA?"--":ff(e.対戦回４位*100,e.対戦回,2)+"%";},function(e){return e.gt&GT.SANMA?"--":e.対戦回４位+"回";}],
	[1,  "連対率","(１位回数 + ２位回数) / 対戦数"	,function(e){return e.gt&GT.SANMA?"--":ff((e.対戦回１位+e.対戦回２位)*100,e.対戦回,2)+"%";}],
	[0,"通算得点",""												,function(e){return fp(ff(e.得点,1,1));}],
	[0,"平均得点",""												,function(e){return fp(ff(e.得点,e.対戦回,2));}],
	[0,"配牌回数","※途中流局・流し満貫を含む"					,function(e){return e.配牌回+"回";}],
	[0,"配牌収支","配牌あたりの収支<br>※途中流局・流し満貫を含む"	,function(e){return fp(ff(e.配牌収支,e.配牌回,2))+"点";}],
	[0,"卓平均R",""												,function(e){return ff(e.卓R,1,2);}],
	[0,"安定R","三麻=卓平均R + 40*30*(2.0 - 平均順位)<br>四麻=卓平均R + 40*20*(2.5 - 平均順位)"				,function(e){return ff(e.安定R,1,2);}],
	[0,"安定段位"],
	[1,  "一般","三麻=(一般１位回数*30 + 一般２位回数* 0)/一般３位回数 - 20)/10<br>四麻=(一般１位回数*30 + 一般２位回数* 0)/一般４位回数 - 20)/10"	,function(e){return e.対戦回一般?e.安定段位一般+"段":"--";},function(e){return e.対戦回一般+"回";}],
	[1,  "上級","三麻=(上級１位回数*50 + 上級２位回数* 0)/上級３位回数 - 20)/10<br>四麻=(上級１位回数*40 + 上級２位回数*10)/上級４位回数 - 20)/10"	,function(e){return e.対戦回上級?e.安定段位上級+"段":"--";},function(e){return e.対戦回上級+"回";}],
	[1,  "特上","三麻=(特上１位回数*70 + 特上２位回数* 0)/特上３位回数 - 20)/10<br>四麻=(特上１位回数*50 + 特上２位回数*20)/特上４位回数 - 20)/10"	,function(e){return e.対戦回特上?e.安定段位特上+"段":"--";},function(e){return e.対戦回特上+"回";}],
	[1,  "鳳凰","三麻=(鳳凰１位回数*90 + 鳳凰２位回数* 0)/鳳凰３位回数 - 20)/10<br>四麻=(鳳凰１位回数*60 + 鳳凰２位回数*30)/鳳凰４位回数 - 20)/10"	,function(e){return e.対戦回鳳凰?e.安定段位鳳凰+"段":"--";},function(e){return e.対戦回鳳凰+"回";}],

	[-1],
	[0,"和了率"        ,"和了回数 / 配牌回数"			,function(e){return ff(e.和了回*100,e.配牌回,2)+"%";},function(e){return e.和了回+"回";}],
	[1,  "ロン"        ,"ロン和了回数 / 和了回数"		,function(e){return ff(e.和了回ロン*100,e.和了回,2)+"%";},function(e){return e.和了回ロン+"回";}],
	[1,  "親"          ,"東家和了回数 / 和了回数"		,function(e){return ff(e.和了回東家*100,e.和了回,2)+"%";},function(e){return e.和了回東家+"回";}],
//	[1,  "南家"        ,"南家和了回数 / 和了回数"		,function(e){return ff(e.和了回南家*100,e.和了回,2)+"%";},function(e){return e.和了回南家+"回";}],
//	[1,  "西家"        ,"西家和了回数 / 和了回数"		,function(e){return ff(e.和了回西家*100,e.和了回,2)+"%";},function(e){return e.和了回西家+"回";}],
//	[1,  "北家"        ,"北家和了回数 / 和了回数"		,function(e){return ff(e.和了回北家*100,e.和了回,2)+"%";},function(e){return e.和了回北家+"回";}],
	[1,  "立直"        ,"立直和了回数 / 和了回数"		,function(e){return ff(e.和了回立直  *100,e.和了回,2)+"%";},function(e){return e.和了回立直  +"回";}],
	[1,  "ダマ"        ,"門前ダマ和了回数 / 和了回数"	,function(e){return ff(e.和了回ダマ  *100,e.和了回,2)+"%";},function(e){return e.和了回ダマ  +"回";}],
	[1,  "副露"        ,"副露和了回数 / 和了回数"		,function(e){return ff(e.和了回副露  *100,e.和了回,2)+"%";},function(e){return e.和了回副露  +"回";}],
	[2,    "１副露"    ,"１副露の和了回数 / 和了回数"	,function(e){return ff(e.和了回１副露*100,e.和了回,2)+"%";},function(e){return e.和了回１副露+"回";}],
	[2,    "２副露"    ,"２副露の和了回数 / 和了回数"	,function(e){return ff(e.和了回２副露*100,e.和了回,2)+"%";},function(e){return e.和了回２副露+"回";}],
	[2,    "３副露"    ,"３副露の和了回数 / 和了回数"	,function(e){return ff(e.和了回３副露*100,e.和了回,2)+"%";},function(e){return e.和了回３副露+"回";}],
	[2,    "４副露"    ,"４副露の和了回数 / 和了回数"	,function(e){return ff(e.和了回４副露*100,e.和了回,2)+"%";},function(e){return e.和了回４副露+"回";}],
	[1,  "素点3900以上" ,"和了素点3900以上回数 / 和了回数"		,function(e){return ff(e.和了回素点3900以上 *100,e.和了回,2)+"%";},function(e){return e.和了回素点3900以上 +"回";}],
	[1,  "素点7700以上" ,"和了素点7700以上回数 / 和了回数"		,function(e){return ff(e.和了回素点7700以上 *100,e.和了回,2)+"%";},function(e){return e.和了回素点7700以上 +"回";}],
	[1,  "素点11600以上","和了素点11600以上回数 / 和了回数"		,function(e){return ff(e.和了回素点11600以上*100,e.和了回,2)+"%";},function(e){return e.和了回素点11600以上+"回";}],
	[1,  "素点満貫以上" ,"和了素点満貫以上回数 / 和了回数"		,function(e){return ff(e.和了回素点満貫以上 *100,e.和了回,2)+"%";},function(e){return e.和了回素点満貫以上+"回";}],
	[0,"和了巡目"   ,""							,function(e){return ff(e.和了巡      ,e.和了回      ,2)+"巡";}],
	[1,  "立直"     ,""							,function(e){return ff(e.和了巡立直  ,e.和了回立直  ,2)+"巡";}],
	[1,  "ダマ"     ,""							,function(e){return ff(e.和了巡ダマ  ,e.和了回ダマ  ,2)+"巡";}],
	[1,  "副露"     ,""							,function(e){return ff(e.和了巡副露  ,e.和了回副露  ,2)+"巡";}],
	[2,    "１副露" ,""							,function(e){return ff(e.和了巡１副露,e.和了回１副露,2)+"巡";}],
	[2,    "２副露" ,""							,function(e){return ff(e.和了巡２副露,e.和了回２副露,2)+"巡";}],
	[2,    "３副露" ,""							,function(e){return ff(e.和了巡３副露,e.和了回３副露,2)+"巡";}],
	[2,    "４副露" ,""							,function(e){return ff(e.和了巡４副露,e.和了回４副露,2)+"巡";}],
	[0,"和了収入"   ,"和了収入 / 和了回数<br>※積み棒・供託を含む"		,function(e){return fp(ff(e.和了収支    ,e.和了回    ,1))+"点";}],
	[0,"和了素点"   ,"和了素点 / 和了回数<br>※積み棒・供託を除く"		,function(e){return fp(ff(e.和了素点    ,e.和了回    ,1))+"点";}],
	[1,  "立直"     ,"立直の和了素点 / 立直和了回数"		,function(e){return fp(ff(e.和了素点立直,e.和了回立直,1))+"点";}],
	[1,  "ダマ"     ,"門前ダマの和了素点 / ダマ和了回数"	,function(e){return fp(ff(e.和了素点ダマ,e.和了回ダマ,1))+"点";}],
	[1,  "副露"     ,"副露の和了素点 / 副露和了回数"		,function(e){return fp(ff(e.和了素点副露,e.和了回副露,1))+"点";}],
	[2,    "１副露" ,"１副露和了素点 / １副露和了回数"		,function(e){return fp(ff(e.和了素点１副露,e.和了回１副露,1))+"点";}],
	[2,    "２副露" ,"２副露和了素点 / ２副露和了回数"		,function(e){return fp(ff(e.和了素点２副露,e.和了回２副露,1))+"点";}],
	[2,    "３副露" ,"３副露和了素点 / ３副露和了回数"		,function(e){return fp(ff(e.和了素点３副露,e.和了回３副露,1))+"点";}],
	[2,    "４副露" ,"４副露和了素点 / ４副露和了回数"		,function(e){return fp(ff(e.和了素点４副露,e.和了回４副露,1))+"点";}],
	[0,"和了役"],
	[1,  "一発","一発和了回数 / 和了回数"			,function(e){return ff(e.和了回一発*100,e.和了回,2)+"%";},function(e){return e.和了回一発+"回";}],
	[1,  "断幺","断幺和了回数 / 和了回数"			,function(e){return ff(e.和了回断幺*100,e.和了回,2)+"%";},function(e){return e.和了回断幺+"回";}],
	[1,  "平和","平和和了回数 / 和了回数"			,function(e){return ff(e.和了回平和*100,e.和了回,2)+"%";},function(e){return e.和了回平和+"回";}],
	[1,  "七対","七対和了回数 / 和了回数"			,function(e){return ff(e.和了回七対*100,e.和了回,2)+"%";},function(e){return e.和了回七対+"回";}],
	[1,  "対々","対々和了回数 / 和了回数"			,function(e){return ff(e.和了回対々*100,e.和了回,2)+"%";},function(e){return e.和了回対々+"回";}],
	[1,  "一色","混一清一和了回数 / 和了回数"		,function(e){return ff(e.和了回一色*100,e.和了回,2)+"%";},function(e){return e.和了回一色+"回";}],
	[1,  "役牌","役牌１種以上の和了回数 / 和了回数"	,function(e){return ff(e.和了回役牌*100,e.和了回,2)+"%";},function(e){return e.和了回役牌+"回";}],
//	[2,  "自風","自風和了飜 / 和了回数"			,function(e){return ff(e.和了飜自風,e.和了回,2)+"飜";},function(e){return e.和了飜自風+"飜";}],
//	[3,  "自風東","自風東和了飜 / 和了回数"		,function(e){return ff(e.和了飜自風東*100,e.和了飜自風,2)+"%";},function(e){return e.和了飜自風東+"飜";}],
//	[3,  "自風南","自風南和了飜 / 和了回数"		,function(e){return ff(e.和了飜自風南*100,e.和了飜自風,2)+"%";},function(e){return e.和了飜自風南+"飜";}],
//	[3,  "自風西","自風西和了飜 / 和了回数"		,function(e){return ff(e.和了飜自風西*100,e.和了飜自風,2)+"%";},function(e){return e.和了飜自風西+"飜";}],
//	[3,  "自風北","自風北和了飜 / 和了回数"		,function(e){return ff(e.和了飜自風北*100,e.和了飜自風,2)+"%";},function(e){return e.和了飜自風北+"飜";}],
//	[2,  "場風","場風和了飜 / 和了回数"			,function(e){return ff(e.和了飜場風,e.和了回,2)+"飜";},function(e){return e.和了飜場風+"飜";}],
//	[3,  "場風東","場風東和了飜 / 和了回数"		,function(e){return ff(e.和了飜場風東*100,e.和了飜場風,2)+"%";},function(e){return e.和了飜場風東+"飜";}],
//	[3,  "場風南","場風南和了飜 / 和了回数"		,function(e){return ff(e.和了飜場風南*100,e.和了飜場風,2)+"%";},function(e){return e.和了飜場風南+"飜";}],
//	[3,  "場風西","場風西和了飜 / 和了回数"		,function(e){return ff(e.和了飜場風西*100,e.和了飜場風,2)+"%";},function(e){return e.和了飜場風西+"飜";}],
//	[3,  "場風北","場風北和了飜 / 和了回数"		,function(e){return ff(e.和了飜場風北*100,e.和了飜場風,2)+"%";},function(e){return e.和了飜場風北+"飜";}],
//	[2,  "三元","役牌三元和了飜 / 和了回数"		,function(e){return ff(e.和了飜三元,e.和了回,2)+"飜";},function(e){return e.和了飜三元    +"飜";}],
//	[3,  "役牌白","役牌白和了飜 / 和了回数"		,function(e){return ff(e.和了飜役牌白*100,e.和了飜三元,2)+"%";},function(e){return e.和了飜役牌白+"飜";}],
//	[3,  "役牌發","役牌發和了飜 / 和了回数"		,function(e){return ff(e.和了飜役牌發*100,e.和了飜三元,2)+"%";},function(e){return e.和了飜役牌發+"飜";}],
//	[3,  "役牌中","役牌中和了飜 / 和了回数"		,function(e){return ff(e.和了飜役牌中*100,e.和了飜三元,2)+"%";},function(e){return e.和了飜役牌中+"飜";}],
	[1,  "ドラ","和了ドラ飜数 / 和了回数<br>※裏/赤/抜きを含む"	,function(e){return ff(e.和了飜ドラ  ,e.和了回,2)+"飜";},function(e){return e.和了飜ドラ  +"飜";}],
	[2,    "赤","和了赤ドラ飜数 / 和了回数"						,function(e){return ff(e.和了飜赤ドラ,e.和了回,2)+"飜";},function(e){return e.和了飜赤ドラ+"飜";}],
	[2,    "裏","和了裏ドラ飜数 / 和了回数"						,function(e){return ff(e.和了飜裏ドラ,e.和了回,2)+"飜";},function(e){return e.和了飜裏ドラ+"飜";}],

	[-1],
	[0,"放銃率"          ,"放銃回数 / 配牌回数<br>※ダブロン１回"	,function(e){return ff(e.放銃回*100,e.配牌回,2)+"%";},function(e){return e.放銃回+"回";}],
	[1,  "件数"          ,"放銃件数"								,function(e){return e.放銃件+"件";}],
	[1,  "親へ"          ,"東家放銃件数 / 放銃件数"				,function(e){return ff(e.放銃件東家*100,e.放銃件,2)+"%";},function(e){return e.放銃件東家+"件";}],
//	[1,  "南家へ"        ,"南家放銃件数 / 放銃件数"				,function(e){return ff(e.放銃件南家*100,e.放銃件,2)+"%";},function(e){return e.放銃件南家+"件";}],
//	[1,  "西家へ"        ,"西家放銃件数 / 放銃件数"				,function(e){return ff(e.放銃件西家*100,e.放銃件,2)+"%";},function(e){return e.放銃件西家+"件";}],
//	[1,  "北家へ"        ,"北家放銃件数 / 放銃件数"				,function(e){return ff(e.放銃件北家*100,e.放銃件,2)+"%";},function(e){return e.放銃件北家+"件";}],
	[1,  "立直へ"        ,"立直への放銃件数 / 放銃件数"			,function(e){return ff(e.放銃件立直へ  *100,e.放銃件,2)+"%";},function(e){return e.放銃件立直へ      +"件";}],
	[1,  "ダマへ"        ,"門前ダマへの放銃件数 / 放銃件数"		,function(e){return ff(e.放銃件ダマへ  *100,e.放銃件,2)+"%";},function(e){return e.放銃件ダマへ      +"件";}],
	[1,  "副露へ"        ,"副露への放銃件数 / 放銃件数"			,function(e){return ff(e.放銃件副露へ  *100,e.放銃件,2)+"%";},function(e){return e.放銃件副露へ      +"件";}],
	[2,    "１副露へ"    ,"１副露への放銃件数 / 放銃件数"			,function(e){return ff(e.放銃件１副露へ*100,e.放銃件,2)+"%";},function(e){return e.放銃件１副露へ    +"件";}],
	[2,    "２副露へ"    ,"２副露への放銃件数 / 放銃件数"			,function(e){return ff(e.放銃件２副露へ*100,e.放銃件,2)+"%";},function(e){return e.放銃件２副露へ    +"件";}],
	[2,    "３副露へ"    ,"３副露への放銃件数 / 放銃件数"			,function(e){return ff(e.放銃件３副露へ*100,e.放銃件,2)+"%";},function(e){return e.放銃件３副露へ    +"件";}],
	[2,    "４副露へ"    ,"４副露への放銃件数 / 放銃件数"			,function(e){return ff(e.放銃件４副露へ*100,e.放銃件,2)+"%";},function(e){return e.放銃件４副露へ    +"件";}],
	[1,  "素点3900以上へ"  ,"素点3900以上への放銃件数 / 放銃件数"	,function(e){return ff(e.放銃件素点3900以上 *100,e.放銃件,2)+"%";},function(e){return e.放銃件素点3900以上 +"件";}],
	[1,  "素点7700以上へ"  ,"素点7700以上への放銃件数 / 放銃件数"	,function(e){return ff(e.放銃件素点7700以上 *100,e.放銃件,2)+"%";},function(e){return e.放銃件素点7700以上 +"件";}],
	[1,  "素点11600以上へ" ,"素点11600以上への放銃件数 / 放銃件数"	,function(e){return ff(e.放銃件素点11600以上*100,e.放銃件,2)+"%";},function(e){return e.放銃件素点11600以上+"件";}],
	[1,  "素点満貫以上へ"  ,"素点満貫以上への放銃件数 / 放銃件数"	,function(e){return ff(e.放銃件素点満貫以上 *100,e.放銃件,2)+"%";},function(e){return e.放銃件素点満貫以上 +"件";}],
	[0,"放銃時"],
	[1,  "立直率*"     ,"立直時の放銃回数 / 放銃回数"				,function(e){return ff(e.放銃回立直時  *100,e.放銃回,2)+"%";},function(e){return e.放銃回立直時    +"回";}],
	[1,  "副露率*"     ,"副露時の放銃回数 / 放銃回数"				,function(e){return ff(e.放銃回副露    *100,e.放銃回,2)+"%";},function(e){return e.放銃回副露      +"回";}],
	[1,  "非副露率*"   ,"非副露時の放銃回数 / 放銃回数"				,function(e){return ff(e.放銃回非副露時*100,e.放銃回,2)+"%";},function(e){return e.放銃回非副露時  +"回";}],
	[1,  "聴牌率*"     ,"聴牌時の放銃回数 / 放銃回数"				,function(e){return ff(e.放銃回聴牌    *100,e.放銃回,2)+"%";},function(e){return e.放銃回聴牌      +"回";}],
	[1,  "向聴*"       ,"放銃時の向聴数"							,function(e){return ff(e.放銃向聴,e.放銃回,3)+"向聴";}],
	[1,  "巡目*"       ,"放銃時の巡目"								,function(e){return ff(e.放銃巡,e.放銃回,2)+"巡";}],
	[0,"放銃支出"      ,"※ダブロンは合算/供託を除く"			,function(e){return fp(ff(e.放銃収支,e.放銃回,1))+"点";}],
	[0,"放銃素点"      ,"※ダブロンは合算/積み棒・供託を除く"	,function(e){return fp(ff(e.放銃素点,e.放銃回,1))+"点";}],
	[1,  "立直へ"      ,"立直への放銃素点"						,function(e){return fp(ff(e.放銃素点立直へ  ,e.放銃件立直へ  ,1))+"点";}],
	[1,  "ダマへ"      ,"門前ダマへの放銃素点"					,function(e){return fp(ff(e.放銃素点ダマへ  ,e.放銃件ダマへ  ,1))+"点";}],
	[1,  "副露へ"      ,"副露への放銃素点"						,function(e){return fp(ff(e.放銃素点副露へ  ,e.放銃件副露へ  ,1))+"点";}],
	[2,    "１副露へ"  ,"１副露への放銃素点"						,function(e){return fp(ff(e.放銃素点１副露へ,e.放銃件１副露へ,1))+"点";}],
	[2,    "２副露へ"  ,"２副露への放銃素点"						,function(e){return fp(ff(e.放銃素点２副露へ,e.放銃件２副露へ,1))+"点";}],
	[2,    "３副露へ"  ,"３副露への放銃素点"						,function(e){return fp(ff(e.放銃素点３副露へ,e.放銃件３副露へ,1))+"点";}],
	[2,    "４副露へ"  ,"４副露への放銃素点"						,function(e){return fp(ff(e.放銃素点４副露へ,e.放銃件４副露へ,1))+"点";}],
	[0,"放銃役"],
	[1,  "一発へ"      ,"一発への放銃件数 / 放銃件数"		,function(e){return ff(e.放銃件一発*100,e.放銃件,2)+"%";},function(e){return e.放銃件一発+"件";}],
	[1,  "断幺へ"      ,"断幺への放銃件数 / 放銃件数"		,function(e){return ff(e.放銃件断幺*100,e.放銃件,2)+"%";},function(e){return e.放銃件断幺+"件";}],
	[1,  "平和へ"      ,"平和への放銃件数 / 放銃件数"		,function(e){return ff(e.放銃件平和*100,e.放銃件,2)+"%";},function(e){return e.放銃件平和+"件";}],
	[1,  "七対へ"      ,"七対への放銃件数 / 放銃件数"		,function(e){return ff(e.放銃件七対*100,e.放銃件,2)+"%";},function(e){return e.放銃件七対+"件";}],
	[1,  "対々へ"      ,"対々への放銃件数 / 放銃件数"		,function(e){return ff(e.放銃件対々*100,e.放銃件,2)+"%";},function(e){return e.放銃件対々+"件";}],
	[1,  "一色へ"      ,"混一清一への放銃件数 / 放銃件数"	,function(e){return ff(e.放銃件一色*100,e.放銃件,2)+"%";},function(e){return e.放銃件一色+"件";}],
	[1,  "役牌へ"      ,"役牌への放銃件数 / 放銃件数"		,function(e){return ff(e.放銃件役牌*100,e.放銃件,2)+"%";},function(e){return e.放銃件役牌+"件";}],
	[1,  "ドラへ"      ,"放銃ドラ飜数 / 放銃回数<br>※裏/赤/抜きを含む"	,function(e){return ff(e.放銃飜ドラ  ,e.放銃回,2)+"飜";},function(e){return e.放銃飜ドラ  +"飜";}],
	[2,    "赤へ"      ,"放銃赤ドラ飜数 / 放銃回数"						,function(e){return ff(e.放銃飜赤ドラ,e.放銃回,2)+"飜";},function(e){return e.放銃飜赤ドラ+"飜";}],
	[2,    "裏へ"      ,"放銃裏ドラ飜数 / 放銃回数"						,function(e){return ff(e.放銃飜裏ドラ,e.放銃回,2)+"飜";},function(e){return e.放銃飜裏ドラ+"飜";}],
	["<tr><td colspan=100>*放銃者、他は和了者</td></tr>"],

	[-1],
	[0,"立直率"        ,"立直回数 / 配牌回数<br>※発声回数"	,function(e){return ff(e.配牌回立直  *100,e.配牌回    ,2)+"%";},function(e){return e.配牌回立直  +"回";}],
	[1,  "和了率"      ,"立直時の和了回数 / 立直回数"		,function(e){return ff(e.和了回立直  *100,e.配牌回立直,2)+"%";},function(e){return e.和了回立直  +"回";}],
	[1,  "放銃率"      ,"立直時の放銃回数 / 立直回数"		,function(e){return ff(e.放銃回立直時*100,e.配牌回立直,2)+"%";},function(e){return e.放銃回立直時+"回";}],
	[1,  "巡目"        ,"立直発声の平均巡目"				,function(e){return ff(e.配牌巡立直,e.配牌回立直      ,2)+"巡";}],
	[1,  "収支"        ,"立直時の収支<br>※和了・放銃・流局の総和<br>※立直供託の1000点を減算せず",function(e){return fp(ff(e.配牌収支立直  ,e.配牌回立直  ,2))+"点";}],
	[2,    "収入"      ,"立直和了収入 / 立直和了回数<br>※立直供託の1000点を減算せず"				,function(e){return fp(ff(e.和了収支立直  ,e.和了回立直  ,2))+"点";}],
	[2,    "支出"      ,"立直時の放銃支出 / 立直放銃回数<br>※立直供託の1000点を減算せず"			,function(e){return fp(ff(e.放銃収支立直時,e.放銃回立直時,2))+"点";}],
	[1,  "先制率"          ,"最初に立直した回数 / 立直回数"			,function(e){return ff(e.配牌回立直先制        *100,e.配牌回立直,2)+"%";},function(e){return e.配牌回立直先制        +"回";}],
	[1,  "追っかけ率"      ,"追っかけ立直した回数 / 立直回数"			,function(e){return ff(e.配牌回立直追っかけ    *100,e.配牌回立直,2)+"%";},function(e){return e.配牌回立直追っかけ    +"回";}],
	[1,  "追っかけられ率"  ,"立直を追っかけられた回数 / 立直回数"		,function(e){return ff(e.配牌回立直追っかけられ*100,e.配牌回立直,2)+"%";},function(e){return e.配牌回立直追っかけられ+"回";}],
	[1,  "良形率"  		,"良形立直回数 / 立直回数"		,function(e){return ff(e.配牌回立直良形*100,e.配牌回立直,2)+"%";},function(e){return e.配牌回立直良形+"回";}],
	[1,  "愚形率"  		,"愚形立直回数 / 立直回数"		,function(e){return ff(e.配牌回立直愚形*100,e.配牌回立直,2)+"%";},function(e){return e.配牌回立直愚形+"回";}],
	[1,  "振聴率"  		,"振聴立直回数 / 立直回数"		,function(e){return ff(e.配牌回立直振聴*100,e.配牌回立直,2)+"%";},function(e){return e.配牌回立直振聴+"回";}],

	[-1],
	[0,"副露率"        ,"副露回数 / 配牌回数"	,function(e){return ff(e.配牌回副露  *100,e.配牌回,2)+"%";},function(e){return e.配牌回副露  +"回";}],
	[1,  "１副露率"    ,"１副露回数 / 副露回数"	,function(e){return ff(e.配牌回１副露*100,e.配牌回副露,2)+"%";},function(e){return e.配牌回１副露+"回";}],
	[1,  "２副露率"    ,"２副露回数 / 副露回数"	,function(e){return ff(e.配牌回２副露*100,e.配牌回副露,2)+"%";},function(e){return e.配牌回２副露+"回";}],
	[1,  "３副露率"    ,"３副露回数 / 副露回数"	,function(e){return ff(e.配牌回３副露*100,e.配牌回副露,2)+"%";},function(e){return e.配牌回３副露+"回";}],
	[1,  "４副露率"    ,"４副露回数 / 副露回数"	,function(e){return ff(e.配牌回４副露*100,e.配牌回副露,2)+"%";},function(e){return e.配牌回４副露+"回";}],
	[0,"副露収支"    ,"副露収支 / 副露回数"				,function(e){return fp(ff(e.配牌収支副露  ,e.配牌回副露  ,2))+"点";}],
	[1,  "１副露"    ,"１副露収支 / １副露の配牌回数"	,function(e){return fp(ff(e.配牌収支１副露,e.配牌回１副露,2))+"点";}],
	[1,  "２副露"    ,"２副露収支 / ２副露の配牌回数"	,function(e){return fp(ff(e.配牌収支２副露,e.配牌回２副露,2))+"点";}],
	[1,  "３副露"    ,"３副露収支 / ３副露の配牌回数"	,function(e){return fp(ff(e.配牌収支３副露,e.配牌回３副露,2))+"点";}],
	[1,  "４副露"    ,"４副露収支 / ４副露の配牌回数"	,function(e){return fp(ff(e.配牌収支４副露,e.配牌回４副露,2))+"点";}],
	[0,"副露巡目"],
	[1,  "１副露"    ,"１副露巡目 / １副露以上の配牌回数",function(e){return ff(e.配牌巡１副露,e.配牌回１副露以上,2)+"巡";}],
	[1,  "２副露"    ,"２副露巡目 / ２副露以上の配牌回数",function(e){return ff(e.配牌巡２副露,e.配牌回２副露以上,2)+"巡";}],
	[1,  "３副露"    ,"３副露巡目 / ３副露以上の配牌回数",function(e){return ff(e.配牌巡３副露,e.配牌回３副露以上,2)+"巡";}],
	[1,  "４副露"    ,"４副露巡目 / ４副露以上の配牌回数",function(e){return ff(e.配牌巡４副露,e.配牌回４副露以上,2)+"巡";}],
	[0,"副露和了巡目",""						,function(e){return ff(e.和了巡副露  ,e.和了回副露  ,2)+"巡";}],
	[1,    "１副露"  ,""						,function(e){return ff(e.和了巡１副露,e.和了回１副露,2)+"巡";}],
	[1,    "２副露"  ,""						,function(e){return ff(e.和了巡２副露,e.和了回２副露,2)+"巡";}],
	[1,    "３副露"  ,""						,function(e){return ff(e.和了巡３副露,e.和了回３副露,2)+"巡";}],
	[1,    "４副露"  ,""						,function(e){return ff(e.和了巡４副露,e.和了回４副露,2)+"巡";}],
	[0,"副露時向聴数"],
	[1,  "１副露"    ,"１副露向聴数 / １副露以上の配牌回数<br>※向聴数は打牌前",function(e){return ff(e.向聴１副露,e.配牌回１副露以上,2)+"向聴";}],
	[1,  "２副露"    ,"２副露向聴数 / ２副露以上の配牌回数<br>※向聴数は打牌前",function(e){return ff(e.向聴２副露,e.配牌回２副露以上,2)+"向聴";}],
	[1,  "３副露"    ,"３副露向聴数 / ３副露以上の配牌回数<br>※向聴数は打牌前",function(e){return ff(e.向聴３副露,e.配牌回３副露以上,2)+"向聴";}],
	[1,  "４副露"    ,"４副露向聴数 / ４副露以上の配牌回数<br>※向聴数は打牌前",function(e){return ff(e.向聴４副露,e.配牌回４副露以上,2)+"向聴";}],
	[0,"副露時和了率","副露の和了回数 / 副露回数"		,function(e){return ff(e.和了回副露  *100,e.配牌回副露  ,2)+"%";},function(e){return e.和了回副露  +"回";}],
	[1,  "１副露"    ,"１副露の和了回数 / １副露回数"	,function(e){return ff(e.和了回１副露*100,e.配牌回１副露,2)+"%";},function(e){return e.和了回１副露+"回";}],
	[1,  "２副露"    ,"２副露の和了回数 / ２副露回数"	,function(e){return ff(e.和了回２副露*100,e.配牌回２副露,2)+"%";},function(e){return e.和了回２副露+"回";}],
	[1,  "３副露"    ,"３副露の和了回数 / ３副露回数"	,function(e){return ff(e.和了回３副露*100,e.配牌回３副露,2)+"%";},function(e){return e.和了回３副露+"回";}],
	[1,  "４副露"    ,"４副露の和了回数 / ４副露回数"	,function(e){return ff(e.和了回４副露*100,e.配牌回４副露,2)+"%";},function(e){return e.和了回４副露+"回";}],
	[0,"副露時放銃率","副露時の放銃回数 / 副露回数"		,function(e){return ff(e.放銃回副露  *100,e.配牌回副露  ,2)+"%";},function(e){return e.放銃回副露  +"回";}],
	[1,  "１副露時"  ,"１副露時の放銃回数 / １副露回数"	,function(e){return ff(e.放銃回１副露*100,e.配牌回１副露,2)+"%";},function(e){return e.放銃回１副露+"回";}],
	[1,  "２副露時"  ,"２副露時の放銃回数 / ２副露回数"	,function(e){return ff(e.放銃回２副露*100,e.配牌回２副露,2)+"%";},function(e){return e.放銃回２副露+"回";}],
	[1,  "３副露時"  ,"３副露時の放銃回数 / ３副露回数"	,function(e){return ff(e.放銃回３副露*100,e.配牌回３副露,2)+"%";},function(e){return e.放銃回３副露+"回";}],
	[1,  "４副露時"  ,"４副露時の放銃回数 / ４副露回数"	,function(e){return ff(e.放銃回４副露*100,e.配牌回４副露,2)+"%";},function(e){return e.放銃回４副露+"回";}],
	[0,"副露時流局聴牌率","副露時の流局聴牌回数 / 副露回数"		,function(e){return ff(e.流局回聴牌副露  *100,e.配牌回副露  ,2)+"%";},function(e){return e.流局回聴牌副露  +"回";}],
	[1,  "１副露時"  ,"１副露時の流局聴牌回数 / １副露回数"	,function(e){return ff(e.流局回聴牌１副露*100,e.配牌回１副露,2)+"%";},function(e){return e.流局回聴牌１副露+"回";}],
	[1,  "２副露時"  ,"２副露時の流局聴牌回数 / ２副露回数"	,function(e){return ff(e.流局回聴牌２副露*100,e.配牌回２副露,2)+"%";},function(e){return e.流局回聴牌２副露+"回";}],
	[1,  "３副露時"  ,"３副露時の流局聴牌回数 / ３副露回数"	,function(e){return ff(e.流局回聴牌３副露*100,e.配牌回３副露,2)+"%";},function(e){return e.流局回聴牌３副露+"回";}],
	[1,  "４副露時"  ,"４副露時の流局聴牌回数 / ４副露回数"	,function(e){return ff(e.流局回聴牌４副露*100,e.配牌回４副露,2)+"%";},function(e){return e.流局回聴牌４副露+"回";}],

	[-1],
	[0,"和了順位不動","順位不動和了回数 / 和了回数<br>※順位変動"	,function(e){return ff(e.和了回順位不動*100,e.和了回,2)+"%";},function(e){return e.和了回順位不動+"回";}],
	[0,"和了順位変動","※順位変動"					,function(e){return fp(ff(e.和了順位変動    ,e.和了回    ,3))+"位";}],
	[1,  "立直"  ,"※順位変動"						,function(e){return fp(ff(e.和了順位変動立直,e.和了回立直,3))+"位";}],
	[1,  "ダマ"  ,"※順位変動"						,function(e){return fp(ff(e.和了順位変動ダマ,e.和了回ダマ,3))+"位";}],
	[1,  "副露"  ,"※順位変動"						,function(e){return fp(ff(e.和了順位変動副露,e.和了回副露,3))+"位";}],
	[0,"放銃順位不動*"     ,"順位不動放銃回数 / 放銃回数<br>※順位変動"	,function(e){return ff(e.放銃回順位不動*100,e.放銃回,2)+"%";},function(e){return e.放銃回順位不動+"回";}],
	[0,"放銃順位変動*"     ,"※順位変動"								,function(e){return fp(ff(e.放銃順位変動,e.放銃回,3))+"位";}],

	[-1],
	[0,"流局率"    ,"流局回数 / 配牌回数<br>※途中流局・流し満貫を除く"	,function(e){return ff(e.流局回*100,e.配牌回,2)+"%";},function(e){return e.流局回+"回";}],
	[1,  "聴牌"    ,"流局聴牌回数 / 流局回数"			,function(e){return ff(e.流局回聴牌    *100,e.流局回    ,2)+"%";},function(e){return e.流局回聴牌    +"回";}],
	[2,    "親"    ,"東家流局聴牌回数 / 流局聴牌回数"	,function(e){return ff(e.流局回聴牌東家*100,e.流局回聴牌,2)+"%";},function(e){return e.流局回聴牌東家+"回";}],
//	[2,    "南家"  ,"南家流局聴牌回数 / 流局聴牌回数"	,function(e){return ff(e.流局回聴牌南家*100,e.流局回聴牌,2)+"%";},function(e){return e.流局回聴牌南家+"回";}],
//	[2,    "西家"  ,"西家流局聴牌回数 / 流局聴牌回数"	,function(e){return ff(e.流局回聴牌西家*100,e.流局回聴牌,2)+"%";},function(e){return e.流局回聴牌西家+"回";}],
//	[2,    "北家"  ,"北家流局聴牌回数 / 流局聴牌回数"	,function(e){return ff(e.流局回聴牌北家*100,e.流局回聴牌,2)+"%";},function(e){return e.流局回聴牌北家+"回";}],
	[2,    "立直"  ,"立直の流局聴牌回数 / 流局聴牌回数"	,function(e){return ff(e.流局回聴牌立直*100,e.流局回聴牌,2)+"%";},function(e){return e.流局回聴牌立直+"回";}],
	[2,    "ダマ"  ,"ダマの流局聴牌回数 / 流局聴牌回数"	,function(e){return ff(e.流局回聴牌ダマ*100,e.流局回聴牌,2)+"%";},function(e){return e.流局回聴牌ダマ+"回";}],
	[2,    "副露"  ,"副露の流局聴牌回数 / 流局聴牌回数"	,function(e){return ff(e.流局回聴牌副露*100,e.流局回聴牌,2)+"%";},function(e){return e.流局回聴牌副露+"回";}],
	[1,  "収支"    ,"流局収支"							,function(e){return fp(ff(e.流局収支    ,e.流局回,1))+"点";}],
	[2,    "聴牌"  ,"流局聴牌時の収入"					,function(e){return fp(ff(e.流局収支聴牌,e.流局回聴牌,1))+"点";},function(e){return e.流局回聴牌+"回";}],
	[2,    "不聴"  ,"流局不聴時の支出"					,function(e){return fp(ff(e.流局収支不聴,e.流局回不聴,1))+"点";},function(e){return e.流局回不聴+"回";}],
	[1,  "順位変動","※順位変動"							,function(e){return fp(ff(e.流局順位変動,e.流局回,3))+"位";}],
	[2,    "聴牌"  ,"流局聴牌時の順位変動<br>※順位変動"	,function(e){return fp(ff(e.流局順位変動聴牌,e.流局回聴牌,3))+"位";}],
	[2,    "不聴"  ,"流局不聴時の順位変動<br>※順位変動"	,function(e){return fp(ff(e.流局順位変動不聴,e.流局回不聴,3))+"位";}],

	[-1],
	[0,"巡目向聴数"],
	[1,    "配牌"    ,"※13枚状態"		,function(e){return ff(e.向聴巡0 ,e.向聴巡回0 ,3)+"向聴";}],
	[1,    "１巡目"  ,"※3n+1枚状態"	,function(e){return ff(e.向聴巡1 ,e.向聴巡回1 ,3)+"向聴";}],
	[1,    "２巡目"  ,"※3n+1枚状態"	,function(e){return ff(e.向聴巡2 ,e.向聴巡回2 ,3)+"向聴";}],
	[1,    "３巡目"  ,"※3n+1枚状態"	,function(e){return ff(e.向聴巡3 ,e.向聴巡回3 ,3)+"向聴";}],
	[1,    "４巡目"  ,"※3n+1枚状態"	,function(e){return ff(e.向聴巡4 ,e.向聴巡回4 ,3)+"向聴";}],
	[1,    "５巡目"  ,"※3n+1枚状態"	,function(e){return ff(e.向聴巡5 ,e.向聴巡回5 ,3)+"向聴";}],
	[1,    "６巡目"  ,"※3n+1枚状態"	,function(e){return ff(e.向聴巡6 ,e.向聴巡回6 ,3)+"向聴";}],
	[1,    "７巡目"  ,"※3n+1枚状態"	,function(e){return ff(e.向聴巡7 ,e.向聴巡回7 ,3)+"向聴";}],
	[1,    "８巡目"  ,"※3n+1枚状態"	,function(e){return ff(e.向聴巡8 ,e.向聴巡回8 ,3)+"向聴";}],
	[1,    "９巡目"  ,"※3n+1枚状態"	,function(e){return ff(e.向聴巡9 ,e.向聴巡回9 ,3)+"向聴";}],
	[1,    "１０巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡10,e.向聴巡回10,3)+"向聴";}],
	[1,    "１１巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡11,e.向聴巡回11,3)+"向聴";}],
	[1,    "１２巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡12,e.向聴巡回12,3)+"向聴";}],
	[1,    "１３巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡13,e.向聴巡回13,3)+"向聴";}],
	[1,    "１４巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡14,e.向聴巡回14,3)+"向聴";}],
	[1,    "１５巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡15,e.向聴巡回15,3)+"向聴";}],
	[1,    "１６巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡16,e.向聴巡回16,3)+"向聴";}],
	[1,    "１７巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡17,e.向聴巡回17,3)+"向聴";}],
	[1,    "１８巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡18,e.向聴巡回18,3)+"向聴";}],
	[1,    "１９巡目","※3n+1枚状態"	,function(e){return ff(e.向聴巡19,e.向聴巡回19,3)+"向聴";}],
	["<tr><td colspan=100>3n+1状態と3n+2状態が混在しています(調整中)</td></tr>"],
	[]
];
function cumulativeOffset(e){for(var x=0,y=0;e;e=e.offsetParent) y+=e.offsetTop || 0, x+=e.offsetLeft || 0;return [x,y];}
function helpShow(node,txt){
	node.style.color="#FF0000";
	txt=MJStatDisp[txt];
	if (!txt || !txt.length) return;
	txt=txt[2];
	var s="";
	s+=txt
//		.replace("※順位変動"		,"※順位変動は(最終順位 - 立直供託後の順位)")
		.replace("※順位変動"		,"※順位変動は立直供託済みの清算直前からダブロン清算後")
		.replace("※ダブロン１回"	,"※ダブロン以上は含まれれば１回");
	s+="<br>";
	var xy=cumulativeOffset(node);
	xy[1]+=node.offsetHeight;
	var h=e("h");
	h.innerHTML=s;
	h.style.visibility="visible";
	h.style.left=xy[0]+"px";
	h.style.top =xy[1]+"px";
/*
	var rc=node.getBoundingClientRect();
s=rc.top+" "+(document.body.scrollTop || document.documentElement.scrollTop);
	rc.left+=document.body.scrollLeft;
	rc.top +=(document.body.scrollTop || document.documentElement.scrollTop) + node.offsetHeight;
	var h=e("h");
	h.innerHTML=s;
	h.style.visibility="visible";
	h.style.left=rc.left+"px";
	h.style.top =rc.top +"px";
*/
};
function helpHide(node){
	node.style.color="";
	e("h").style.visibility="hidden";
}
///////////////////////////////////////////////////////////////////
function show(){
	var s="";
	if (debug && debug.length) s+=debug+"<hr>";
	if (targetFileTW && targetFileTW.length) s+="<br>※次の特定の牌譜を解析しています<br><a href=\"http://tenhou.net/0/?log="+targetFileTW+"\">http://tenhou.net/0/?log="+targetFileTW+"</a><br>";
	s+="<table border=0 cellspacing=0 cellpadding=3 >";

	for(var i=0;i<MJStatDisp.length;++i){
		var a=MJStatDisp[i];
		if (a.length) switch(a[0]){
		case -1:
			s+="<tr><th colspan=3></th>";
			for(var j=0;j<c.length;++j){
				s+="<th><br>"+to_safe_html(decodeURIComponent(c[j].プレーヤ名));
				if (!i) s+="<br><a href=\"#\" onclick=\"delcol("+j+");\">削除</a>";
				s+="</th>";
			}
			s+="</tr>";
			break;
		case 0:
		case 1:
		case 2:
		case 3:
			s+="<tr onmouseover='helpShow(this,\""+(a[2]?i:"")+"\");' onmouseout='helpHide(this);' onclick='hilite(this);' >";
			s+="<td class=c0 colspan=3 style='border-left:"+(a[0]*15)+"px solid #FFFFFF;'>"+a[1]+"</td>";
			for(var j=0;j<c.length;++j){
				s+="<td class=c1>"+(a[3]?a[3](c[j]):"")+"</td>";
				if (a[4] && j==c.length-1) s+="<td class=c2>"+a[4](c[j])+"</td>";
			}
			s+="</tr>";
			break;
		default:
			s+=a[0];
			break;
		}
	}

	s+="</table>"
	s+="<br>";

	if (c.length) s+="<div><button onclick='show_text(this);'>"+to_safe_html(decodeURIComponent(c[c.length-1].プレーヤ名))+"の解析結果をテキストで表示</button></div>";
	if (c.length) s+="<div><button onclick='show_filetw(this);'>"+to_safe_html(decodeURIComponent(c[c.length-1].プレーヤ名))+"の特定の牌譜を解析(不具合検査用)</button></div>";
	eh('c',s);
/*
	var oov=function(){this.style.color="#FF0000";helpShow(this);}
	var oot=function(){this.style.color="";helpHide();}
	var i,a=ei("c","TR");
	for(i=1;i<a.length;++i){
		var e=a[i];
		e.onmouseover=oov;
		e.onmouseout =oot;
	}
*/
}
function delcol(i){
	c.splice(i,1);
	show();
}
function show_text(e){
	var s="";
	s+="<textarea rows=20 style='width:100%;'>";
	var cc=c[c.length-1];
	for(var i in MJStatList) s+=MJStatList[i]+":"+cc[MJStatList[i]]+"\n";
	s+="</textarea>";
	e.outerHTML=s;
}
function show_filetw(e){
	var s="";
	var i;
	for(i=0;i<filetw.length;++i){
		s+="("+i+") <a href=\"?"+filetw[i]+"\">選択</a> http://tenhou.net/0/?log="+filetw[i]+"<br>";
	}
	e.outerHTML=s;
}
///////////////////////////////////////////////////////////////////
eh('v',document.title+" / LogAna Ver"+we.mjCommand("VERSION"));
function start(){uiGetEnumParam(document.f), logana.analyze(window);}
function stop(){logana.stop();}
function selchange(){stop(), setTimeout(start,1);}
function init(){uiCreate(document.f,{show_lobby:true,rule_pf:2|4|8|16|32|64,use_taku:true});selchange();}
init();
</script>
</body></html>
